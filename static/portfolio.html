{{ define "portfolio" }}
{{ template "header" .}}

<section class="summary">
    <h3>Summary</h3>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>1M</th>
                <th>6M</th>
                <th>1Y</th>
                <th>3Y</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td data-label="Name">Porfolio</td>
                <td data-label="1M">{{ index .AvgPortfolioReturns 30 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="6M">{{ index .AvgPortfolioReturns 180 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="1Y">{{ index .AvgPortfolioReturns 360 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="3Y">{{ index .AvgPortfolioReturns 1080 | FormatNumber | Color | SafeHTML}}</td>
            </tr>
            <tr>
                <td data-label="Name">NIFTY500</td>
                <td data-label="1M">{{ index .AvgIndexReturns 30 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="6M">{{ index .AvgIndexReturns 180 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="1Y">{{ index .AvgIndexReturns 360 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="3Y">{{ index .AvgIndexReturns 1080 | FormatNumber | Color | SafeHTML}}</td>
            </tr>
        </tbody>
    </table>
</section>

<section class="detail">
    <h3>Portfolio</h3>
    <table>
        <thead>
            <tr>
                <th>Stock</th>
                <th>1M</th>
                <th>6M</th>
                <th>1Y</th>
                <th>3Y</th>
            </tr>
        </thead>

        <tbody>
            {{ range $key, $value := .AvgStockReturns }}
            <tr>
                <td data-label="Stock">{{$key}}</td>
                <td data-label="1M">{{ index $value 30 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="6M">{{ index $value 180 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="1Y">{{ index $value 360 | FormatNumber | Color | SafeHTML}}</td>
                <td data-label="3Y">{{ index $value 1080 | FormatNumber | Color | SafeHTML}}</td>
            </tr>
            {{ end }}
        </tbody>

    </table>
</section>

<section class="chart">
    <h2>Amount Invested</h2>
    <p>If you'd invested Rs 10000 3 years back it would be worth Rs</p>
    <div style="width: 800px;">
        <canvas id="line-chart" width="400" height="450"></canvas>
    </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="text/javascript">
    const ctx = document.getElementById('line-chart');

    var portfolio_returns_data = []
    var index_returns_data = []

    {{ range.DailyPortfolioReturns }}
portfolio_returns_data.push({
    x: "{{.Date }}",
y: "{{.CurrentInvested }}"
});
{{ end }}

{{ range.DailyIndexReturns }}
index_returns_data.push({
    x: "{{.Date }}",
y: "{{.CurrentInvested }}"
});
{{ end }}



    new Chart(ctx, {
    type: 'line',
    data: {
        datasets: [{
            data: portfolio_returns_data,
            label: "Portfolio",
            borderColor: "#fb5607",
            fill: false
        },
        {
            data: index_returns_data,
            label: "Nifty 500",
            borderColor: "#8338ec",
            fill: false
        }]
    },
    options: {
                responsive: true,
                title:{
                    display:true,
                    text:'Chart.js Line Chart'
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                        display: true,
                        type: 'time',
                        time: {
                            displayFormats: {'day': 'MM/YY'},
    tooltipFormat: 'DD/MM/YY',
    unit: 'day',
                            },
                        scaleLabel: {
                            display: true,
                            labelString: 'Month'
                        }
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Value'
                        }
                    }]
                }
            }
});
</script>
{{ template "footer" .}}
{{ end }}